{"version":3,"sources":["pubnub-common.js"],"names":["pubnub","wrappers","initConfig","instance","getInstance","default_instance_name","init","instanceName","length","attributes_to_delegate","forEach","attribute","wrapAttribute","Object","defineProperty","get","methods_to_delegate","method","wrapMethod","defaultInstance","apply","arguments","args","subscribe","unsubscribe","channel","getMessage","callback","getPresence","getStatus","getError","clean","release"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;AAGE,kBAAYA,MAAZ,EAAoB;AAAA;;AAClB,SAAKA,MAAL,GAAcA,MAAd;AACA,SAAKC,QAAL,GAAgB,EAAhB;AACD;;;;yBAOIC,U,EAAY;;AAEf,UAAIC,WAAW,KAAKC,WAAL,CAAiB,iBAAOC,qBAAxB,CAAf;;AAEAF,eAASG,IAAT,CAAcJ,UAAd;;AAEA,aAAOC,QAAP;AACD;;;gCAQWI,Y,EAAc;AAAA;;AACxB,UAAIJ,WAAW,KAAKF,QAAL,CAAcM,YAAd,CAAf;;AAEA,UAAIJ,YAAYA,oCAAhB,EAA6C;AAC3C,eAAOA,QAAP;AACD,OAFD,MAEO,IAAI,OAAOI,YAAP,KAAwB,QAAxB,IAAoCA,aAAaC,MAAb,GAAsB,CAA9D,EAAiE;AACtE,aAAKP,QAAL,CAAcM,YAAd,IAA8B,qBAAYA,YAAZ,EAA0B,KAAKP,MAA/B,CAA9B;;AAEA,yBAAOS,sBAAP,CAA8BC,OAA9B,CAAsC,UAACC,SAAD,EAAe;AACnD,gBAAKV,QAAL,CAAcM,YAAd,EAA4BK,aAA5B,CAA0CD,SAA1C;;AAEA,cAAI,CAAC,MAAKA,SAAL,CAAL,EAAsB;AACpBE,mBAAOC,cAAP,QAA4BH,SAA5B,EAAuC;AACrCI,mBAAK,eAAY;AACf,uBAAO,KAAKX,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+CM,SAA/C,CAAP;AACD;AAHoC,aAAvC;AAKD;AACF,SAVD;;AAYA,yBAAOK,mBAAP,CAA2BN,OAA3B,CAAmC,UAACO,MAAD,EAAY;AAC7C,gBAAKhB,QAAL,CAAcM,YAAd,EAA4BW,UAA5B,CAAuCD,MAAvC;;AAEA,cAAI,CAAC,MAAKA,MAAL,CAAL,EAAmB;AACjB,kBAAKA,MAAL,IAAe,YAAY;AACzB,kBAAIE,kBAAkB,KAAKf,WAAL,CAAiB,iBAAOC,qBAAxB,CAAtB;AACA,qBAAOc,gBAAgBF,MAAhB,EAAwBG,KAAxB,CAA8BD,eAA9B,EAA+CE,SAA/C,CAAP;AACD,aAHD;AAID;AACF,SATD;;AAWA,eAAO,KAAKpB,QAAL,CAAcM,YAAd,CAAP;AACD;;AAED,aAAOJ,QAAP;AACD;;;8BAOSmB,I,EAAM;AACd,WAAKlB,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+CkB,SAA/C,CAAyDD,IAAzD;AACD;;;gCAOWA,I,EAAM;AAChB,WAAKlB,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+CmB,WAA/C,CAA2DF,IAA3D;AACD;;;+BASUG,O,EAAkB;AAAA;;AAAA,wCAANH,IAAM;AAANA,YAAM;AAAA;;AAC3B,aAAO,qBAAKlB,WAAL,CAAiB,iBAAOC,qBAAxB,GAA+CqB,UAA/C,sBAA0DD,OAA1D,SAAsEH,IAAtE,EAAP;AACD;;;gCAQWG,O,EAASE,Q,EAAU;AAC7B,WAAKvB,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+CuB,WAA/C,CAA2DH,OAA3D,EAAoEE,QAApE;AACD;;;8BAQSF,O,EAASE,Q,EAAU;AAC3B,WAAKvB,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+CwB,SAA/C,CAAyDJ,OAAzD,EAAkEE,QAAlE;AACD;;;6BAOQA,Q,EAAU;AACjB,WAAKvB,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+CyB,QAA/C,CAAwDH,QAAxD;AACD;;;0BAOKF,O,EAAS;AACb,WAAKrB,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+C0B,KAA/C,CAAqDN,OAArD;AACD;;;4BAOOA,O,EAAS;AACf,WAAKrB,WAAL,CAAiB,iBAAOC,qBAAxB,EAA+C2B,OAA/C,CAAuDP,OAAvD;AACD","file":"pubnub-common.js","sourcesContent":["import config from '../config.json';\nimport { Wrapper } from './wrapper';\n\nexport default class {\n  constructor(pubnub) {\n    this.pubnub = pubnub;\n    this.wrappers = {};\n  }\n\n  /**\n   * Initializer for default instance\n   *\n   * @param {Object} initConfig\n   */\n  init(initConfig) {\n\n    let instance = this.getInstance(config.default_instance_name);\n\n    instance.init(initConfig);\n\n    return instance;\n  }\n\n  /**\n   * Instance getter\n   *\n   * @param instanceName\n   * @returns {Wrapper}\n   */\n  getInstance(instanceName) {\n    let instance = this.wrappers[instanceName];\n\n    if (instance && instance instanceof Wrapper) {\n      return instance;\n    } else if (typeof instanceName === 'string' && instanceName.length > 0) {\n      this.wrappers[instanceName] = new Wrapper(instanceName, this.pubnub);\n\n      config.attributes_to_delegate.forEach((attribute) => {\n        this.wrappers[instanceName].wrapAttribute(attribute);\n\n        if (!this[attribute]) {\n          Object.defineProperty(this, attribute, {\n            get: function () {\n              return this.getInstance(config.default_instance_name)[attribute];\n            }\n          });\n        }\n      });\n\n      config.methods_to_delegate.forEach((method) => {\n        this.wrappers[instanceName].wrapMethod(method);\n\n        if (!this[method]) {\n          this[method] = function () {\n            let defaultInstance = this.getInstance(config.default_instance_name);\n            return defaultInstance[method].apply(defaultInstance, arguments);\n          };\n        }\n      });\n\n      return this.wrappers[instanceName];\n    }\n\n    return instance;\n  }\n\n  /**\n   * Subscribe method wrapped for default instance\n   *\n   * @param {object} args\n   */\n  subscribe(args) {\n    this.getInstance(config.default_instance_name).subscribe(args);\n  }\n\n  /**\n   * Unsubscribe method wrapped for default instance\n   *\n   * @param {object} args\n   */\n  unsubscribe(args) {\n    this.getInstance(config.default_instance_name).unsubscribe(args);\n  }\n\n  /**\n   * GetMessage method wrapped for default instance\n   *\n   * @param {string|[string]} channel\n   * @param callback\n   * @returns [object] array\n   */\n  getMessage(channel, ...args) {\n    return this.getInstance(config.default_instance_name).getMessage(channel, ...args);\n  }\n\n  /**\n   * GetPresence method wrapped for default instance\n   *\n   * @param {string|[string]} channel\n   * @param callback\n   */\n  getPresence(channel, callback) {\n    this.getInstance(config.default_instance_name).getPresence(channel, callback);\n  }\n\n  /**\n   * GetStatus method wrapped for default instance\n   *\n   * @param {string|[string]} channel\n   * @param callback\n   */\n  getStatus(channel, callback) {\n    this.getInstance(config.default_instance_name).getStatus(channel, callback);\n  }\n\n  /**\n   * GetError method wrapped for default instance\n   *\n   * @param callback\n   */\n  getError(callback) {\n    this.getInstance(config.default_instance_name).getError(callback);\n  }\n\n  /**\n   * Clean Method wrapped for default instance\n   *\n   * @param {string|[string]} channel\n   */\n  clean(channel) {\n    this.getInstance(config.default_instance_name).clean(channel);\n  }\n\n  /**\n   * Release Method wrapped for default instance\n   *\n   * @param {string|[string]} channel\n   */\n  release(channel) {\n    this.getInstance(config.default_instance_name).release(channel);\n  }\n}\n"]}